# 高性能计算导论 PA0

> 2017011620  计73  李家昊

### OpenMP 版本

在 `openmp_pow.cpp` 修改后函数 `pow_a` 的源代码如下

```cpp
void pow_a(int *a, int *b, int n, int m) {
    // TODO: 使用 omp parallel for 并行这个循环
#pragma omp parallel for
    for (int i = 0; i < n; i++) {
        int x = 1;
        for (int j = 0; j < m; j++)
            x *= a[i];
        b[i] = x;
    }
}
```

使用 1, 7, 14, 28 线程在 $n=112000$，$m=100000$ 下的运行时间，以及相对单线程的加速比，如下表所示。

| 线程数量 | 运行时间（us） | 加速比  |
| -------- | -------------- | ------- |
| 1        | 7772634        | 1.0000  |
| 7        | 1298878        | 5.9841  |
| 14       | 681817         | 11.3999 |
| 28       | 341333         | 22.7714 |

### MPI 版本

在 `mpi_pow.cpp` 中修改后函数 `pow_a` 的源代码如下

```cpp
void pow_a(int *a, int *b, int n, int m, int comm_sz /* 总进程数 */) {
    // TODO: 对这个进程拥有的数据计算 b[i] = a[i]^m
    for (int i = 0; i < n / comm_sz; i++) {
        int x = 1;
        for (int j = 0; j < m; j++)
            x *= a[i];
        b[i] = x;
    }
}
```

使用 $1\times 1$，$1\times 7$，$1\times 14$，$1\times 28$，$2 \times 28$，$4 \times 28$ 进程（$N×P$ 表示 $N$ 台机器，每台机器 $P$ 个进程）在 $n=112000$，$m=100000$ 下的运行时间，以及相对单进程的加速比，如下表所示。

| 线程数量      | 运行时间（us） | 加速比  |
| ------------- | -------------- | ------- |
| $1\times 1$   | 7780533        | 1.0000  |
| $1\times 7$   | 1374685        | 5.6599  |
| $1\times 14$  | 755360         | 10.3004 |
| $1 \times 28$ | 385194         | 20.1990 |
| $2\times 28$  | 233461         | 33.3269 |
| $4\times 28$  | 134869         | 57.6896 |

